# Прототип URL Shortener REST API
## Краткое описание
REST-сервис для сокращения ссылок на Java. Используемые технологии:
- Spring (Boot, MVC, Data);
- Lombok;
- H2 Database;
- Hashids.

Для запуска сервиса склонировать проект и запустить UrlShortenerApplication.java

## Генерация короткой ссылки
Для создания короткой ссылки используется библиотека Hashids, она принимает полный URL и генерирует токен, размер и используемые символы которого настраиваются.
Далее с помощью готового префикса (REDIRECTION_PREFIX) я создаю и возвращаю короткую ссылку.

Готовый префикс "http://localhost:8080/" использовал для удобства, можно возвращать просто токен.

## Внешний программный интерфейс
Есть 5 эндпоинтов для работы с сервисом:
- POST /generate - принимает полный URL и возвращает короткую ссылку;
- GET /{token} - перенаправляет на оригинальный URL по короткой ссылке;
- POST /admin - возвращает статистику по переданной короткой ссылке;
- PATCH /admin - устанавливает срок жизни ссылки;
- DELETE /admin - удаляет зарегистрированную ссылку.

### POST /generate 
Для создания новой короткой ссылки необходимо послать POST-запрос на адрес /generate. 

В теле запроса дожен находиться объект в формате JSON со строковым параметром originalURL, в который передаётся полный URL.

В ответе возвращается объект с полем shortURL, в котором указывается сгенерированная короткая ссылка.

Перед генерацией происходит проверка, если полный URL уже содержится в БД и срок действия не истёк, то возвращается уже готовая короткая ссылка. В противном случае генерируется и сохраняется новая.

### GET /{token} перенаправление
Для перенаправления нужно отправить GET-запрос по короткой ссылке.

Будет проведена проверка на наличие в БД данной ссылки и редирект в случае успеха, иначе вернется код 404 NOT FOUND.

### POST /admin статистика
Для получения статистики по указанной ссылке нужно послать POST-запрос на адрес /admin.

В теле запроса отправить JSON объект с параметром shortURL, в котором указать интересующую короткую ссылку.

В ответе вернётся объект с следующими полями:
- token - сгенерированный токен
- originalURL - исходная ссылка
- redirects - количество осуществлённых переходов по короткой ссылке
- createdAt - дата создания ссылки
- expiredAt - дата истечения срока жизни ссылки (null если не установлен)

Если ссылки не существует вернётся код 404 NOT FOUND

### PATCH /admin задание срока жизни ссылки
Для задания срока жизни ссылке нужно послать PATCH-запрос на адрес /admin.

В теле запроса отправить JSON объект с параметрами shortURL и daysToExpired.

Если ссылка существует и обновлена вернется код 200 ОК, иначе 404 NOT FOUND.

### DELETE /admin удаление ссылки
Для удаления ссылки послать DELETE-запрос на адрес /admin.

В теле запроса отправить JSON объект с параметром shortURL.

Если ссылка существует и удалена вернется код 200 ОК, иначе 404 NOT FOUND.
