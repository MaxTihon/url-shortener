# Прототип URL Shortener REST API
## Краткое описание
REST-сервис для сокращения ссылок на Java.

Пользователь отправляет полный URL-адрес и получает короткую ссылку. При создании короткой ссылки можно задать её срок жизни.
При переходе на короткую ссылку осуществляется перенаправление на полный URL-адрес, ведётся подсчёт переходов по ссылкам. Есть возможность получения статистики по ссылкам.

Используемые технологии:
- Spring Boot, SpringDataJpa;
- Lombok;
- H2 Database;
- Hashids.

Для запуска сервиса склонировать проект и запустить UrlShortenerApplication.java

## Генерация короткой ссылки
Для создания короткой ссылки используется библиотека Hashids, она принимает полный URL и генерирует токен. Размер и вид токена настраиваются переменными в application.properties.
Далее из HttpServletRequest я получаю адрес, откуда вызван контроллер, добавляю токен и получаю короткую ссылку.

## Внешний программный интерфейс
Есть 5 эндпоинтов для работы с сервисом:
- POST /app - принимает полный URL и возвращает короткую ссылку;
- GET /{token} - перенаправляет на оригинальный URL по короткой ссылке;
- GET /app/{token} - возвращает статистику по переданной короткой ссылке;
- DELETE /app/{token} - удаляет зарегистрированную ссылку.

### POST /app 
Для создания новой короткой ссылки необходимо послать POST-запрос на адрес /app. 

В теле запроса отправить JSON со параметром originalUrl(полный URL) и expiredAt(дата окончания срока действия ссылки). Параметр expiredAt может быть null.

В ответе возвращается JSON с полем shortURL(новая короткая ссылка).

Перед генерацией происходит проверка, если полный URL уже содержится в БД, а срок действия короткой ссылки не истёк, то возвращается уже ранее созданная короткая ссылка. В противном случае генерируется и сохраняется новая.

### GET /{token} перенаправление
Для перенаправления нужно отправить GET-запрос по короткой ссылке или просто перейти по ссылке.

Будет проведена проверка на наличие в БД данной ссылки, в случае успеха счётчик переходов увеличится и осуществится переход на полный URL-адрес, иначе вернется код 404 NOT FOUND.

### GET /app/{token} статистика
Для получения статистики по указанной ссылке нужно послать GET-запрос на адрес /app/{token}.

В ответе вернётся объект с следующими полями:
- token - сгенерированный токен
- originalURL - исходная ссылка
- redirects - количество осуществлённых переходов по короткой ссылке
- createdAt - дата создания ссылки
- expiredAt - дата истечения срока жизни ссылки (null если не установлен)

Если ссылки не существует вернётся код 404 NOT FOUND

### DELETE /app/{token} удаление ссылки
Для удаления ссылки послать DELETE-запрос на адрес /app/{token}.

Если ссылка существует и удалена вернется код 200 ОК, иначе 404 NOT FOUND.
